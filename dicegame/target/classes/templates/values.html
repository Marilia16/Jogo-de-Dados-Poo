<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Hist√≥rico de Valores</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link th:href="@{/css/layout.css}" rel="stylesheet">
</head>
<body class="bg-dark text-white">

<!-- Sidebar -->
<div th:replace="fragments/layout :: menu-sidebar"></div>

<div class="main-content">

    <!-- Header -->
    <div th:replace="fragments/layout :: header"></div>

    <div class="header-space"></div>

    <main class="container">

        <h1 class="fw-bold mb-4">üí∞ Hist√≥rico de Movimenta√ß√µes</h1>

        <div class="card bg-secondary bg-opacity-25 text-white border-0 shadow-sm p-3">

            <table class="table table-dark table-hover align-middle">
                <thead>
                <tr>
                    <th>#</th>
                    <th>Valor Anterior</th>
                    <th>Novo Valor</th>
                    <th>Varia√ß√£o</th>
                    <th>Motivo</th>
                    <th>Data</th>
                </tr>
                </thead>

                <tbody>
                <tr th:each="h : ${history}">
                    <td th:text="${h.id}"></td>

                    <!-- oldValue -->
                    <td th:text="${h.oldValue != null ? #numbers.formatDecimal(h.oldValue, 1, 2) : '0.00'}"></td>

                    <!-- newValue -->
                    <td th:text="${h.newValue != null ? #numbers.formatDecimal(h.newValue, 1, 2) : '0.00'}"></td>

                    <!-- diff -->
                    <td>

                        <span th:if="${h.diff > 0}"
                            class="text-success fw-bold"
                            th:text="|+${#numbers.formatDecimal(h.diff, 1, 2)}|"></span>

                        <span th:if="${h.diff < 0}"
                            class="text-danger fw-bold"
                            th:text="${#numbers.formatDecimal(h.diff, 1, 2)}"></span>

                        <span th:if="${h.diff == 0}"
                            class="text-warning fw-bold">0.00</span>

                    </td>

                    <td th:text="${h.reason}"></td>

                    <td th:text="${#temporals.format(h.changedAt, 'dd/MM/yyyy HH:mm')}"></td>
                </tr>
                </tbody>

            </table>

            <div th:if="${#lists.isEmpty(history)}"
                 class="alert alert-secondary text-center mt-4">
                Nenhuma movimenta√ß√£o encontrada.
            </div>

        </div>

    </main>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
